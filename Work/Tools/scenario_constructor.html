<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="file:///C:/Users/bois/AppData/Local/Pandoc/css/scholmd-heuristically-latest.min.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="usrbinenv-python">! /usr/bin/env python</h1>
<h1 id="codingutf8---">-<em>- coding:Utf8 -</em>-</h1>
<h1 id="section"></h1>
<h1 id="generation-of-scenarios-which-can-be-used-inside-modelica-as-input.">Generation of scenarios which can be used inside Modelica as input.</h1>
<h1 id="section-1"></h1>
<p>import csv</p>
<p>from itertools import chain, islice</p>
<p>def chunks_iterator(iterable, size, out_format=tuple): “”“Can be used to extract element by chunk from many iterable (tuple, list, generator, files, …) &gt;&gt;&gt; l = [“a”, “b”, “c”, “d”, “e”, “f”, “g”] &gt;&gt;&gt; for morceau in morceaux(l, 3): … print(morceau) (”a“,”b“,”c“) (”d“,”e“,”f“) (”g“,)”“” it = iter(iterable) # Will break when chain throws the warning StopIteration. while True: # Yield next element in the iterable followed by the next size - 1 elements yield out_format(chain((next(it),), islice(it, size - 1)))</p>
<p>def extract_rows_from(input_file, delimiter=“,”, map_format=int, encoding=“utf-8”, mode=‘r’): “”“Extract a table from a csv file. Return a generator of rows”“” with open(input_file, mode=mode, encoding=encoding) as csv: for row in csv.readlines(): yield [el for el in map(map_format, row[:-1].split(delimiter))]</p>
<p>def extract_columns_from(input_file, headers=None, caster=(int, float), delimiter=“,”, encoding=“utf-8”, mode=‘r’): “”“Extract a table from a csv file. Return a generator of columns”“” fieldnames = headers or [1, 2, 3, 4, 5, 6, 7] with open(input_file, mode=mode, encoding=encoding) as csv_file: reader = csv.DictReader(csv_file, delimiter=delimiter, fieldnames=fieldnames) mapper = {} for row in reader: for col in row: # Float if “.” in row[col]: mapper.setdefault(col, <a href="#section-1"></a>).append(caster<a href="row%5Bcol%5D">1</a>) # Integer else: mapper.setdefault(col, <a href="#section-1"></a>).append(caster<a href="row%5Bcol%5D">0</a>) return mapper</p>
<p>def week_schedule_from_table(files, start=0, step_size=1, out_format=list, **kwargs): “”“Construct a schedule base on a table as input file. Each columns will be concatenated together and time step added for each value. Each file will be added as a new column inside the table.</p>
<pre><code>:param files: Can be a list of path or just a unique file path.
&quot;&quot;&quot;
time_step = start
schedule = &quot;[&quot;
if hasattr(files, &quot;pop&quot;):
    mappers = [extract_columns_from(file_input, **kwargs) for file_input in files]
else:
    mappers = [extract_columns_from(files, **kwargs)]
for col in mappers[0]:
    for index in range(0, len(mappers[0][col])):
        elements = &quot;, &quot;.join(map(str, [mapper[col][index] for mapper in mappers]))
        schedule += &quot;{}, {}; &quot;.format(time_step * step_size, elements)
        time_step += 1
# Used to double the last step due to how combitable on Modelica works
# Necessary only when using `Modelica.Blocks.Types.Extrapolation.Periodic`.
schedule += &quot;{}, {}; &quot;.format(time_step * step_size, elements)
return schedule[:-2] + &quot;]&quot;</code></pre>
<p>def construct_table(input_file, start=0, step_size=1, <strong>kwargs): “”“Construct a schedule base on a table as input file. Each row will be map to a time step beginning at start.”“” table = extract_rows_from(input_file, </strong>kwargs) time_step = start scenario = “[&quot; + “,”.join(map(str, [time_step] + next(table))) for row in table: time_step += 1 scenario = scenario + “;”.format(time_step * step_size) + “,”.join(map(str, row)) return scenario + “]”</p>
<p>if <strong>name</strong> == ‘<strong>main</strong>’: # TEST</p>
<pre><code># # Test chunks_iterator.
# alist = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 70.0, 70.0, 70.0,
#          70.0, 70.0, 70.0, 70.0, 70.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
#          0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 70.0, 70.0, 70.0,
#          70.0, 70.0, 70.0, 70.0, 70.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
#          0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 70.0, 70.0, 70.0,
#          70.0, 70.0, 70.0, 70.0, 70.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
#          0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 70.0, 70.0, 70.0,
#          70.0, 70.0, 70.0, 70.0, 70.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
#          0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 70.0, 70.0, 70.0,
#          70.0, 70.0, 70.0, 70.0, 70.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
#          0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 70.0, 70.0, 70.0,
#          70.0, 70.0, 70.0, 70.0, 70.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
#          0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 70.0, 70.0, 70.0,
#          70.0, 70.0, 70.0, 70.0, 70.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# for el in chunks_iterator(alist, 24):
#     print(el)

# # Test extract_rows_from.
# table = extract_rows_from(&quot;table.csv&quot;)
# for row in table:
#     print(row)

# # Test construct_table.
# print(construct_table(&quot;table.csv&quot;, delimiter=&quot;,&quot;))

# # Test extract_columns_from.
# print(extract_columns_from(&quot;table.csv&quot;)[1])

# Test week_schedule_from_table.
# week_schedule_from_table([&quot;table.csv&quot;, &quot;table.csv&quot;, &quot;table.csv&quot;])

#
# Generation of IGC schedules
#
# FOLDER = &quot;D://Github//Projets//IGC//Etudes//Simulations_Air_Solaire_maisonIndividuelle//Simulations//Scenarios//&quot;
FOLDER = &quot;D://Github//Projets//IGC//Etudes//Simulations_Air_Solaire_maisonIndividuelle//Etude//Scenarios//&quot;
occupancy, lights, equipments = FOLDER + &quot;occupancy.csv&quot;, FOLDER + &quot;lights.csv&quot;, FOLDER + &quot;equipments_RT2012.csv&quot;

consigne, solaire, ventilation = FOLDER + &quot;consigne.csv&quot;, FOLDER + &quot;solaire.csv&quot;, FOLDER + &quot;ventilation.csv&quot;
consigneRT = FOLDER + &quot;consigneRT.csv&quot;
hiver_occ = FOLDER + &quot;occultation_hiver.csv&quot;
ete_est_occ, ete_ouest_occ = FOLDER + &quot;occultation_ete_est.csv&quot;, FOLDER + &quot;occultation_ete_ouest.csv&quot;
puisage = FOLDER + &quot;puisage.csv&quot;

consigne_19_16 = FOLDER + &quot;consigne_19_16.csv&quot;
consigne_19_18_16 = FOLDER + &quot;consigne_19_18_16.csv&quot;
consigne_20_18, consigne_solaire_22_10, ventilation_hygroB = (FOLDER + &quot;consigne_20_18.csv&quot;,
                                                              FOLDER + &quot;consigne_solaire_22_10.csv&quot;,
                                                              FOLDER + &quot;ventilation_hygroB.csv&quot;)

# schedule = week_schedule_from_table([occupancy, lights, equipments],
#                                     step_size=3600, delimiter=&quot;,&quot;)
schedule = week_schedule_from_table([consigne_19_18_16, consigne_solaire_22_10, ventilation_hygroB],
                                    step_size=3600, delimiter=&quot;,&quot;)
# schedule = week_schedule_from_table([consigne_19_16, consigne_solaire_22_10, ventilation_hygroB],
#                                     step_size=3600, delimiter=&quot;,&quot;)
# schedule = week_schedule_from_table([ventilation],
#                                     step_size=3600, delimiter=&quot;,&quot;)
# schedule = week_schedule_from_table([consigne, solaire],
#                                     step_size=3600, delimiter=&quot;,&quot;)
# schedule = week_schedule_from_table(consigneRT,
#                                     step_size=3600, delimiter=&quot;,&quot;)
# schedule = week_schedule_from_table([occupancy, lights, equipments, hiver_occ, ete_est_occ, ete_ouest_occ],
#                                     step_size=3600, delimiter=&quot;,&quot;)
# schedule = week_schedule_from_table(FOLDER + &quot;puisage_matin.csv&quot;,
#                                     step_size=3600, delimiter=&quot;,&quot;)
print(schedule)</code></pre>
</body>
</html>
